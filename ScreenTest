#include <iostream>
#include <vector>
#include <sys/ioctl.h>
#include <unistd.h>
#include <cstdio>

void clearScreen() {
    std::cout << "\033[2J\033[H";
}

int main() {
    struct winsize w;
    if (ioctl(STDOUT_FILENO, TIOCGWINSZ, &w) == -1) {
        perror("ioctl");
        return 1;
    }

    int rows = w.ws_row;
    int cols = w.ws_col;

    // Create a screen buffer
    std::vector<std::string> screen(rows, std::string(cols, ' '));

    // Example content: a moving character
    int x = 0;
    int y = 0;

    while (true) {
        // Clear the screen buffer
        for (int i = 0; i < rows; ++i) {
            std::fill(screen[i].begin(), screen[i].end(), ' ');
        }

        // Update the buffer with the content
        screen[y][x] = '@';

        // Print the buffer to the terminal
        clearScreen();
        for (const auto& line : screen) {
            std::cout << line << '\n';
        }

        // Update the position of the character
        x = (x + 1) % cols;
        y = (y + 1) % rows;

        // Delay for a short period to create animation effect
        usleep(100000); // 100 milliseconds
    }

    return 0;
}
